---
import TagPosts from "@layouts/TagPosts.astro";
import getPostsByTag from "@utils/getPostsByTag";
import getPagination from "@utils/getPagination";
import getUniqueTags from "@utils/getUniqueTags";
import i18next, { t, changeLanguage } from "i18next";
import { getPostsByLang } from "@utils/getPosts";

changeLanguage("en");

export async function getStaticPaths() {
    const posts = await getPostsByLang(i18next.language);
    const tags = getUniqueTags(posts);
    return tags.map(({ tag, tagName }) => {
        return {
            params: { tag },
            props: { tag, tagName, posts },
        };
    });
}
const { tag, posts } = Astro.props;
// console.log("tags [tag] index", posts.length);
const postsByTag = getPostsByTag(posts, tag);
const pagination = getPagination({
    posts: postsByTag,
    page: 1,
    isIndex: true,
});
---

<TagPosts {...pagination} {tag} tagName={t(`tags:${tag}`)} />
